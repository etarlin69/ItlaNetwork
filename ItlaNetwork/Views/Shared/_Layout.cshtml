@using ItlaNetwork.Core.Application.DTOs.Account
@using ItlaNetwork.Extensions
@using Microsoft.AspNetCore.Http

@{
    var user = Context.Session.Get<AuthenticationResponse>("user");
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ItlaNetwork</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="stylesheet" href="~/css/main-styles.css" asp-append-version="true" />
</head>
<body class="main-body">
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-dark glass-panel box-shadow">
            @* ... (El código del navbar no cambia) ... *@
        </nav>
    </header>

    <div class="container main-content-area">
        @if (user != null)
        {
            <nav class="secondary-nav mt-4">
                <a class="@(currentController == "Home" ? "nav-link active" : "nav-link")" asp-controller="Home" asp-action="Index"><i class="fa-solid fa-house"></i> Home</a>
                <a class="@(currentController == "Friend" ? "nav-link active" : "nav-link")" asp-controller="Friend" asp-action="Index"><i class="fa-solid fa-user-group"></i> Amigos</a>
                <a class="@(currentController == "FriendRequest" ? "nav-link active" : "nav-link")" asp-controller="FriendRequest" asp-action="Index"><i class="fa-solid fa-bell"></i> Solicitudes</a>
            </nav>
        }
        <main role="main" class="py-3">
            @* --- BLOQUE DE NOTIFICACIONES AÑADIDO --- *@
            @{
                var successMessage = TempData["Success"] as string;
                var errorMessage = TempData["Error"] as string;
            }
            @if (!string.IsNullOrEmpty(successMessage))
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    @successMessage
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
            @if (!string.IsNullOrEmpty(errorMessage))
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    @errorMessage
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }

            @RenderBody()
        </main>
    </div>

    <footer class="footer text-muted glass-panel">
        @* ... (El código del footer no cambia) ... *@
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>